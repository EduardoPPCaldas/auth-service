# Development Dockerfile with Delve debugger
FROM golang:1.25-alpine

WORKDIR /app

# Install git and Delve debugger
RUN apk add --no-cache git && \
    go install github.com/go-delve/delve/cmd/dlv@latest

# Copy go mod files
COPY go.mod go.sum ./

# Download dependencies
RUN go mod download

# Copy source code
COPY . .

# Add Delve to PATH
ENV PATH=$PATH:/go/bin

# Expose application port and debug port
EXPOSE 8080 2345

# Default command - will be overridden by docker-compose
CMD ["dlv", "debug", "./cmd/api/main.go", "--listen=:2345", "--headless=true", "--api-version=2", "--accept-multiclient"]

